function removeErrors(e) { e.querySelectorAll(".contact__error-border").forEach(e => { e.classList.remove("contact__error-border"), e.querySelector(".show-error").remove("show-error") }), e.querySelector(".alert").classList.remove("show-alert", "success", "error") } function showErrors(e) { e.forEach(e => { if (!e.valid) { let r = document.querySelectorAll(".contact__input")[e.index].parentElement; r.classList.add("contact__error-border"); let t = r.querySelector(".contact__error"); t.classList.add("show-error"), t.querySelector(".error-msg").textContent = e.error } }), console.log("Invalid Form") } function showAlert(e) { let r = document.querySelector(".alert"); "Fail" === e || 400 === e || e === {} ? (r.classList.add("error", "show-alert"), r.querySelector("span").textContent = "Unable to send Email!") : "OK" !== e && 200 !== e || (r.classList.add("success", "show-alert"), r.querySelector("span").textContent = "Email Sent!") } function isEmpty(e) { return 0 !== e.length && "" !== e ? e.length >= 2 && e.length <= 75 ? [!0, ""] : [!1, "2-75 characters max."] : [!1, "Field is empty"] } document.querySelector("form.contact__form").addEventListener("submit", e => { e.preventDefault(); const r = document.querySelector("form.contact__form"), t = r.querySelectorAll(".contact__input"); let o = []; if (t.forEach((e, r) => { o.push({ name: e.name, id: e.id, type: e.type, value: e.value, index: r, valid: !1, error: "", pattern: () => "email" === e.type ? /^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i : /^[a-zA-Z'-,. ]{2,45}$/ }) }), o.forEach(e => { let r = isEmpty(e.value); if (!r[0]) return e.valid = r[0], e.error = r[1], !1; e.valid = r[0], e.error = r[1], patternMatchTest(e) ? (e.valid = !0, e.error = "") : (e.valid = !1, e.error = "Invalid characters") }), removeErrors(r), o.every(e => !!e.valid)) { const e = { name: o[0].value, email: o[1].value, subject: o[2].value, message: o[3].value }; document.querySelector("button[type=submit]").innerHTML = 'Loading... <i class="uil uil-message button__icon"></i>', fetch("https://api.emailjs.com/api/v1.0/email/send", { method: "POST", headers: { "Content-Type": "application/json" }, body: JSON.stringify({ service_id: "service_562kegs", template_id: "template_2owpp5u", user_id: "user_pwnrSymGTUtZ4MVyEqwmT", template_params: e }) }).then(e => e.text()).then(e => { document.querySelector("button[type=submit]").innerHTML = 'Send Message <i class="uil uil-message button__icon"></i>', removeErrors(r), showAlert(e) }).catch(e => { console.log("Oops... " + e) }) } else showErrors(o); e.preventDefault() }); const patternMatchTest = e => e.pattern().test(e.value);